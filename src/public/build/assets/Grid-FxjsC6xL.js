import{e as R}from"./domHelpers-BtKPVOZb.js";import{A as vt}from"./AppRequest-B2BOAsCr.js";var A=function(){return A=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c])}return t},A.apply(this,arguments)};typeof window<"u"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=function(t,n){n=n||{bubbles:!1,cancelable:!1,detail:null};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),r}));var bt=typeof document<"u"&&!!document.documentMode,ot;function yt(){return ot||(ot=document.createElement("div").style)}var ht=["webkit","moz","ms"],Q={};function ut(e){if(Q[e])return Q[e];var t=yt();if(e in t)return Q[e]=e;for(var n=e[0].toUpperCase()+e.slice(1),r=ht.length;r--;){var s="".concat(ht[r]).concat(n);if(s in t)return Q[e]=s}}function J(e,t){return parseFloat(t[ut(e)])||0}function K(e,t,n){n===void 0&&(n=window.getComputedStyle(e));var r=t==="border"?"Width":"";return{left:J("".concat(t,"Left").concat(r),n),right:J("".concat(t,"Right").concat(r),n),top:J("".concat(t,"Top").concat(r),n),bottom:J("".concat(t,"Bottom").concat(r),n)}}function F(e,t,n){e.style[ut(t)]=n}function wt(e,t){var n=ut("transform");F(e,"transition","".concat(n," ").concat(t.duration,"ms ").concat(t.easing))}function xt(e,t,n){var r=t.x,s=t.y,c=t.scale,g=t.isSVG;if(F(e,"transform","scale(".concat(c,") translate(").concat(r,"px, ").concat(s,"px)")),g&&bt){var y=window.getComputedStyle(e).getPropertyValue("transform");e.setAttribute("transform",y)}}function it(e){var t=e.parentNode,n=window.getComputedStyle(e),r=window.getComputedStyle(t),s=e.getBoundingClientRect(),c=t.getBoundingClientRect();return{elem:{style:n,width:s.width,height:s.height,top:s.top,bottom:s.bottom,left:s.left,right:s.right,margin:K(e,"margin",n),border:K(e,"border",n)},parent:{style:r,width:c.width,height:c.height,top:c.top,bottom:c.bottom,left:c.left,right:c.right,padding:K(t,"padding",r),border:K(t,"border",r)}}}var U={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};typeof window<"u"&&(typeof window.PointerEvent=="function"?U={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:typeof window.TouchEvent=="function"&&(U={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));function st(e,t,n,r){U[e].split(" ").forEach(function(s){t.addEventListener(s,n,r)})}function ct(e,t,n){U[e].split(" ").forEach(function(r){t.removeEventListener(r,n)})}function pt(e,t){for(var n=e.length;n--;)if(e[n].pointerId===t.pointerId)return n;return-1}function dt(e,t){var n;if(t.touches){n=0;for(var r=0,s=t.touches;r<s.length;r++){var c=s[r];c.pointerId=n++,dt(e,c)}return}n=pt(e,t),n>-1&&e.splice(n,1),e.push(t)}function Ct(e,t){if(t.touches){for(;e.length;)e.pop();return}var n=pt(e,t);n>-1&&e.splice(n,1)}function mt(e){e=e.slice(0);for(var t=e.pop(),n;n=e.pop();)t={clientX:(n.clientX-t.clientX)/2+t.clientX,clientY:(n.clientY-t.clientY)/2+t.clientY};return t}function lt(e){if(e.length<2)return 0;var t=e[0],n=e[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-t.clientX),2)+Math.pow(Math.abs(n.clientY-t.clientY),2))}function Mt(e){for(var t=e;t&&t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1}function Et(e){return(e.getAttribute("class")||"").trim()}function Pt(e,t){return e.nodeType===1&&" ".concat(Et(e)," ").indexOf(" ".concat(t," "))>-1}function At(e,t){for(var n=e;n!=null;n=n.parentNode)if(Pt(n,t.excludeClass)||t.exclude.indexOf(n)>-1)return!0;return!1}var It=/^http:[\w\.\/]+svg$/;function Nt(e){return It.test(e.namespaceURI)&&e.nodeName.toLowerCase()!=="svg"}function Bt(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var gt={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",handleStartEvent:function(e){e.preventDefault(),e.stopPropagation()},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!1,pinchAndPan:!1,relative:!1,setTransform:xt,startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};function St(e,t){if(!e)throw new Error("Panzoom requires an element as an argument");if(e.nodeType!==1)throw new Error("Panzoom requires an element with a nodeType of 1");if(!Mt(e))throw new Error("Panzoom should be called on elements that have been attached to the DOM");t=A(A({},gt),t);var n=Nt(e),r=e.parentNode;r.style.overflow=t.overflow,r.style.userSelect="none",r.style.touchAction=t.touchAction,(t.canvas?r:e).style.cursor=t.cursor,e.style.userSelect="none",e.style.touchAction=t.touchAction,F(e,"transformOrigin",typeof t.origin=="string"?t.origin:n?"0 0":"50% 50%");function s(){r.style.overflow="",r.style.userSelect="",r.style.touchAction="",r.style.cursor="",e.style.cursor="",e.style.userSelect="",e.style.touchAction="",F(e,"transformOrigin","")}function c(a){a===void 0&&(a={});for(var d in a)a.hasOwnProperty(d)&&(t[d]=a[d]);(a.hasOwnProperty("cursor")||a.hasOwnProperty("canvas"))&&(r.style.cursor=e.style.cursor="",(t.canvas?r:e).style.cursor=t.cursor),a.hasOwnProperty("overflow")&&(r.style.overflow=a.overflow),a.hasOwnProperty("touchAction")&&(r.style.touchAction=a.touchAction,e.style.touchAction=a.touchAction)}var g=0,y=0,v=1,T=!1;o(t.startScale,{animate:!1,force:!0}),setTimeout(function(){_(t.startX,t.startY,{animate:!1,force:!0})});function O(a,d,m){if(!m.silent){var b=new CustomEvent(a,{detail:d});e.dispatchEvent(b)}}function Z(a,d,m){var b={x:g,y,scale:v,isSVG:n,originalEvent:m};return requestAnimationFrame(function(){typeof d.animate=="boolean"&&(d.animate?wt(e,d):F(e,"transition","none")),d.setTransform(e,b,d),O(a,b,d),O("panzoomchange",b,d)}),b}function W(a,d,m,b){var l=A(A({},t),b),w={x:g,y,opts:l};if(!l.force&&(l.disablePan||l.panOnlyWhenZoomed&&v===l.startScale))return w;if(a=parseFloat(a),d=parseFloat(d),l.disableXAxis||(w.x=(l.relative?g:0)+a),l.disableYAxis||(w.y=(l.relative?y:0)+d),l.contain){var f=it(e),q=f.elem.width/v,D=f.elem.height/v,j=q*m,V=D*m,X=(j-q)/2,Y=(V-D)/2;if(l.contain==="inside"){var et=(-f.elem.margin.left-f.parent.padding.left+X)/m,nt=(f.parent.width-j-f.parent.padding.left-f.elem.margin.left-f.parent.border.left-f.parent.border.right+X)/m;w.x=Math.max(Math.min(w.x,nt),et);var rt=(-f.elem.margin.top-f.parent.padding.top+Y)/m,at=(f.parent.height-V-f.parent.padding.top-f.elem.margin.top-f.parent.border.top-f.parent.border.bottom+Y)/m;w.y=Math.max(Math.min(w.y,at),rt)}else if(l.contain==="outside"){var et=(-(j-f.parent.width)-f.parent.padding.left-f.parent.border.left-f.parent.border.right+X)/m,nt=(X-f.parent.padding.left)/m;w.x=Math.max(Math.min(w.x,nt),et);var rt=(-(V-f.parent.height)-f.parent.padding.top-f.parent.border.top-f.parent.border.bottom+Y)/m,at=(Y-f.parent.padding.top)/m;w.y=Math.max(Math.min(w.y,at),rt)}}return l.roundPixels&&(w.x=Math.round(w.x),w.y=Math.round(w.y)),w}function G(a,d){var m=A(A({},t),d),b={scale:v,opts:m};if(!m.force&&m.disableZoom)return b;var l=t.minScale,w=t.maxScale;if(m.contain){var f=it(e),q=f.elem.width/v,D=f.elem.height/v;if(q>1&&D>1){var j=f.parent.width-f.parent.border.left-f.parent.border.right,V=f.parent.height-f.parent.border.top-f.parent.border.bottom,X=j/q,Y=V/D;t.contain==="inside"?w=Math.min(w,X,Y):t.contain==="outside"&&(l=Math.max(l,X,Y))}}return b.scale=Math.min(Math.max(a,l),w),b}function _(a,d,m,b){var l=W(a,d,v,m);return g!==l.x||y!==l.y?(g=l.x,y=l.y,Z("panzoompan",l.opts,b)):{x:g,y,scale:v,isSVG:n,originalEvent:b}}function o(a,d,m){var b=G(a,d),l=b.opts;if(!(!l.force&&l.disableZoom)){a=b.scale;var w=g,f=y;if(l.focal){var q=l.focal;w=(q.x/a-q.x/v+g*a)/a,f=(q.y/a-q.y/v+y*a)/a}var D=W(w,f,a,{relative:!1,force:!0});return g=D.x,y=D.y,v=a,Z("panzoomzoom",l,m)}}function i(a,d){var m=A(A(A({},t),{animate:!0}),d);return o(v*Math.exp((a?1:-1)*m.step),m)}function u(a){return i(!0,a)}function h(a){return i(!1,a)}function p(a,d,m,b){var l=it(e),w={width:l.parent.width-l.parent.padding.left-l.parent.padding.right-l.parent.border.left-l.parent.border.right,height:l.parent.height-l.parent.padding.top-l.parent.padding.bottom-l.parent.border.top-l.parent.border.bottom},f=d.clientX-l.parent.left-l.parent.padding.left-l.parent.border.left-l.elem.margin.left,q=d.clientY-l.parent.top-l.parent.padding.top-l.parent.border.top-l.elem.margin.top;n||(f-=l.elem.width/v/2,q-=l.elem.height/v/2);var D={x:f/w.width*(w.width*a),y:q/w.height*(w.height*a)};return o(a,A(A({},m),{animate:!1,focal:D}),b)}function I(a,d){a.preventDefault();var m=A(A(A({},t),d),{animate:!1}),b=a.deltaY===0&&a.deltaX?a.deltaX:a.deltaY,l=b<0?1:-1,w=G(v*Math.exp(l*m.step/3),m).scale;return p(w,a,m,a)}function P(a){var d=A(A(A({},t),{animate:!0,force:!0}),a);v=G(d.startScale,d).scale;var m=W(d.startX,d.startY,v,d);return g=m.x,y=m.y,Z("panzoomreset",d)}var S,B,N,M,E,x,C=[];function k(a){if(!At(a.target,t)){dt(C,a),T=!0,t.handleStartEvent(a),S=g,B=y,O("panzoomstart",{x:g,y,scale:v,isSVG:n,originalEvent:a},t);var d=mt(C);N=d.clientX,M=d.clientY,E=v,x=lt(C)}}function z(a){if(!(!T||S===void 0||B===void 0||N===void 0||M===void 0)){dt(C,a);var d=mt(C),m=C.length>1,b=v;if(m){x===0&&(x=lt(C));var l=lt(C)-x;b=G(l*t.step/80+E).scale,p(b,d,{animate:!1},a)}(!m||t.pinchAndPan)&&_(S+(d.clientX-N)/b,B+(d.clientY-M)/b,{animate:!1},a)}}function L(a){C.length===1&&O("panzoomend",{x:g,y,scale:v,isSVG:n,originalEvent:a},t),Ct(C,a),T&&(T=!1,S=B=N=M=void 0)}var $=!1;function H(){$||($=!0,st("down",t.canvas?r:e,k),st("move",document,z,{passive:!0}),st("up",document,L,{passive:!0}))}function tt(){$=!1,ct("down",t.canvas?r:e,k),ct("move",document,z),ct("up",document,L)}return t.noBind||H(),{bind:H,destroy:tt,eventNames:U,getPan:function(){return{x:g,y}},getScale:function(){return v},getOptions:function(){return Bt(t)},handleDown:k,handleMove:z,handleUp:L,pan:_,reset:P,resetStyle:s,setOptions:c,setStyle:function(a,d){return F(e,a,d)},zoom:o,zoomIn:u,zoomOut:h,zoomToPoint:p,zoomWithWheel:I}}St.defaultOptions=gt;class Ot{constructor(t){this.sleep=n=>new Promise(r=>setTimeout(r,n)),this.container=t,this.emptyBoxTime=null,this.processing=!1,this.queue=[],this.items=[],this.breakpoints=this.parseDataCols(this.container.dataset.cols||""),this.currentColCount=0,this.setupColumns(),window.addEventListener("resize",()=>this.refreshColumns())}parseDataCols(t){const n={sm:null,md:null,lg:null,xl:null};t.split(" ").forEach(s=>{const[c,g]=s.split(":");c&&g&&(n[c]=parseInt(g))});const r=["sm","md","lg","xl"];for(let s=0;s<r.length;s++)n[r[s]]===null&&(n[r[s]]=s>0?n[r[s-1]]:1);return n}getColumnCount(){const t=window.innerWidth;switch(!0){case t>=1200:return this.breakpoints.xl;case t>=992:return this.breakpoints.lg;case t>=768:return this.breakpoints.md}return this.breakpoints.sm}setupColumns(){this.container.querySelectorAll(".flow").forEach(r=>r.remove()),this.currentColCount=this.getColumnCount();const t=(100/this.currentColCount).toFixed(6)+"%",n=document.createDocumentFragment();for(let r=0;r<this.currentColCount;r++){const s=document.createElement("div");s.className="col flow p-1",s.style.width=t,n.appendChild(s)}this.container.prepend(n)}refreshColumns(t=!1){const n=this.getColumnCount();if(t||n!==this.currentColCount){const r=[...this.items];this.clear(),this.setupColumns(),r.forEach(s=>this.addItem(s))}this.toggleMessageBox()}queueItem(t){this.queue.push(t),this.processQueue()}async processQueue(){if(!this.processing){for(this.processing=!0;this.queue.length>0;){const t=this.queue.shift();this.addItem(t),await this.sleep(100)}this.container.dispatchEvent(new CustomEvent("grid.complete",{})),this.processing=!1}}addItem(t){this.getShortestColumn().appendChild(t),this.items.push(t),this.container.dispatchEvent(new CustomEvent("grid.refresh",{detail:this.items})),requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.classList.add("show")})}),this.toggleMessageBox()}removeItem(t){t.classList.remove("show"),setTimeout(()=>{t.parentElement&&t.parentElement.removeChild(t),this.items=this.items.filter(n=>n!==t),this.refreshColumns(!0)},300)}getShortestColumn(){return Array.from(this.container.querySelectorAll(".flow")).reduce((n,r)=>r.scrollHeight<n.scrollHeight?r:n)}clear(){this.items=[],this.queue=[],this.container.querySelectorAll(".flow").forEach(n=>n.innerHTML=""),this.toggleMessageBox()}toggleMessageBox(){const t=this.container.querySelector(".empty-grid");t&&(this.items.length===0&&!this.emptyBoxTimer?(t.classList.remove("d-none"),this.emptyBoxTimer=setTimeout(()=>{t.classList.add("show")},400)):this.items.length!==0&&(t.classList.remove("show"),t.offsetHeight,t.classList.add("d-none"),clearTimeout(this.emptyBoxTimer),this.emptyBoxTimer=null))}}const ft=(function(e){const t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],n=o=>{let i=0;for(let u=0;u<o.length;u++){const h=o[u],p=t.indexOf(h);i=i*83+p}return i},r=(o,i)=>{var u="";for(let h=1;h<=i;h++){let p=Math.floor(o)/Math.pow(83,i-h)%83;u+=t[Math.floor(p)]}return u},s=o=>{let i=o/255;return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)},c=o=>{let i=Math.max(0,Math.min(1,o));return i<=.0031308?Math.round(i*12.92*255+.5):Math.round((1.055*Math.pow(i,.4166666666666667)-.055)*255+.5)},g=o=>o<0?-1:1,y=(o,i)=>g(o)*Math.pow(Math.abs(o),i),v=o=>{if(!o||o.length<6)throw new Error("The blurhash string must be at least 6 characters");const i=n(o[0]),u=Math.floor(i/9)+1,h=i%9+1;if(o.length!==4+2*h*u)throw new Error(`blurhash length mismatch: length is ${o.length} but it should be ${4+2*h*u}`)},T=o=>{const i=o>>16,u=o>>8&255,h=o&255;return[s(i),s(u),s(h)]},O=(o,i)=>{const u=Math.floor(o/361),h=Math.floor(o/19)%19,p=o%19;return[y((u-9)/9,2)*i,y((h-9)/9,2)*i,y((p-9)/9,2)*i]},W=(o,i,u,h)=>{let p=0,I=0,P=0;const S=i*4;for(let N=0;N<i;N++)for(let M=0;M<u;M++){const E=h(N,M);p+=E*s(o[4*N+0+M*S]),I+=E*s(o[4*N+1+M*S]),P+=E*s(o[4*N+2+M*S])}let B=1/(i*u);return[p*B,I*B,P*B]},G=o=>{const i=c(o[0]),u=c(o[1]),h=c(o[2]);return(i<<16)+(u<<8)+h},_=(o,i)=>{let u=Math.floor(Math.max(0,Math.min(18,Math.floor(y(o[0]/i,.5)*9+9.5)))),h=Math.floor(Math.max(0,Math.min(18,Math.floor(y(o[1]/i,.5)*9+9.5)))),p=Math.floor(Math.max(0,Math.min(18,Math.floor(y(o[2]/i,.5)*9+9.5))));return u*19*19+h*19+p};return e.decodePromise=(o,i,u,h=1)=>new Promise((p,I)=>{p(e.decode(o,i,u,h))}),e.decode=(o,i,u,h=1)=>{v(o),h=h|1;const p=n(o[0]),I=Math.floor(p/9)+1,P=p%9+1,B=(n(o[1])+1)/166,N=new Array(P*I);for(let x=0;x<N.length;x++)if(x===0){const C=n(o.substring(2,6));N[x]=T(C)}else{const C=n(o.substring(4+x*2,6+x*2));N[x]=O(C,B*h)}const M=i*4,E=new Uint8ClampedArray(M*u);for(let x=0;x<u;x++)for(let C=0;C<i;C++){let k=0,z=0,L=0;for(let a=0;a<I;a++)for(let d=0;d<P;d++){const m=Math.cos(Math.PI*C*d/i)*Math.cos(Math.PI*x*a/u);let b=N[d+a*P];k+=b[0]*m,z+=b[1]*m,L+=b[2]*m}let $=c(k),H=c(z),tt=c(L);E[4*C+0+x*M]=$,E[4*C+1+x*M]=H,E[4*C+2+x*M]=tt,E[4*C+3+x*M]=255}return E},e.encodePromise=(o,i,u,h,p)=>new Promise((I,P)=>{I(e.encode(o,i,u,h,p))}),e.encode=(o,i,u,h,p)=>{if(h<1||h>9||p<1||p>9)throw new Error("BlurHash must have between 1 and 9 components");if(i*u*4!==o.length)throw new Error("Width and height must match the pixels array");let I=[];for(let E=0;E<p;E++)for(let x=0;x<h;x++){const C=x==0&&E==0?1:2,k=W(o,i,u,(z,L)=>C*Math.cos(Math.PI*x*z/i)*Math.cos(Math.PI*E*L/u));I.push(k)}const P=I[0],S=I.slice(1);let B="",N=h-1+(p-1)*9;B+=r(N,1);let M;if(S.length>0){let E=Math.max(...S.map(C=>Math.max(...C))),x=Math.floor(Math.max(0,Math.min(82,Math.floor(E*166-.5))));M=(x+1)/166,B+=r(x,1)}else M=1,B+=r(0,1);return B+=r(G(P),4),S.forEach(E=>{B+=r(_(E,M),2)}),B},e.getImageData=o=>{const i=o.width,u=o.height,h=document.createElement("canvas"),p=h.getContext("2d");return h.width=i,h.height=u,p.width=i,p.height=u,p.drawImage(o,0,0),p.getImageData(0,0,i,u).data},e.drawImageDataOnNewCanvas=(o,i,u)=>{const h=document.createElement("canvas"),p=h.getContext("2d");return h.width=i,h.height=u,p.width=i,p.height=u,p.putImageData(new ImageData(o,i,u),0,0),h},e.getImageDataAsImageWithOnloadPromise=(o,i,u)=>new Promise((h,p)=>{e.getImageDataAsImage(o,i,u,(I,P)=>{h(P)})}),e.getImageDataAsImage=(o,i,u,h)=>{const I=e.drawImageDataOnNewCanvas(o,i,u).toDataURL(),P=new Image(i,u);return P.onload=S=>h(S,P),P.width=i,P.height=u,P.src=I,P},e})({});class Dt{constructor(t,n="grid"){this.sleep=r=>new Promise(s=>setTimeout(s,r)),this.container=typeof n=="string"?document.getElementById(n):n,this.manager=t,this.rendering=!1,this.observer=!0,this.items=[],this.masonry=new Ot(this.container),this.container.addEventListener("grid.complete",()=>{this.observer&&this.setupObserver()})}add(t){const n=Array.isArray(t)?t:[t];n.forEach(r=>{this._append(r)}),this.items=this.items.concat(n)}async render(){if(!this.rendering){for(this.rendering=!0;this.items.length;)this._append(this.items.shift());this.rendering=!1}}_append(t){this.masonry.queueItem(t),this.container.dispatchEvent(new CustomEvent("grid.queued_item",{detail:{item:t}}))}remove(t){this.masonry.removeItem(t)}clear(){this.masonry.clear(),this.items=[]}setupObserver(){const t=this.container.querySelectorAll(".grid-item");if(!t.length)return;new IntersectionObserver(async(r,s)=>{for(const c of r)c.isIntersecting&&!vt.isLoading()&&(s.disconnect(),await this.manager.showMore())},{rootMargin:"200px"}).observe(t[t.length-1])}}const kt={folder(e){const t=document.createElement("div");t.className="grid-item card folder selectable clickable my-1";const n=document.createElement("div");n.className="card-body text-primary position-relative w-100 ratio ratio-4x3 p-3",t.appendChild(n);const r=document.createElement("div");r.className="d-flex align-items-center justify-content-center";const s=document.createElement("img");s.className="h-75 w-75",s.src="images/folder.png",r.appendChild(s);const c=document.createElement("img");c.className="position-absolute w-75 mt-2",c.src=`folders/${e.id}/thumbnail`,r.appendChild(c),n.appendChild(r);const g=document.createElement("div");return g.className="card-footer text-center text-truncate overflow-hidden",g.textContent=e.name,g.title=e.name,t.appendChild(g),t},photoFolder(e,t){const n=document.createElement("a");n.href=e.path_full,n.setAttribute("data-id",e.id),n.setAttribute("data-type","image"),n.className="grid-item card file selectable clickable thumbnail my-1";const r=document.createElement("div");r.className="card-body text-primary position-relative w-100 ratio ratio-4x3 p-3",r.style.backgroundImage=`url(${e.path_thumb})`,r.style.backgroundSize="cover",n.appendChild(r);const s=document.createElement("div");s.className="d-flex align-items-center justify-content-center";const c=R("check-circle-fill","opacity-75");s.appendChild(c),r.appendChild(s);const g=document.createElement("div");return g.className="card-footer text-center text-truncate overflow-hidden",g.textContent=e.filename,g.title=e.filename,n.appendChild(g),n},async photo(e,t=!0){const n=Math.min(250/e.width,1),r=Math.round(e.width*n),s=Math.round(e.height*n),c=document.createElement("a");c.id=`card-${e.id}`,c.href=e.path_full,c.setAttribute("data-id",e.id),c.setAttribute("data-type","image"),c.style.cssText=`width: 100%; aspect-ratio: ${r} / ${s};`,c.className="grid-item clickable selectable position-relative thumbnail w-100 p-0 my-1";const g=R("check-circle-fill","position-absolute top-50 start-50 translate-middle");c.appendChild(g);const y=document.createElement("div");y.className="img-container text-primary position-relative d-inline-block align-items-center text-center";const v=await this._createBlurHash(e,r,s);v.className="d-block w-100 h-100 m-0 blurhash",v.removeAttribute("height"),v.removeAttribute("width"),c.appendChild(v);const T=document.createElement("img");T.className="d-block w-100 h-100 opacity-0 m-0",T.src=e.path_thumb,c.appendChild(T);const O=document.createElement("div");return O.className="d-block card-img-overlay bg-dark text-light fw-semibold quick-actions top p-1",c.appendChild(O),O.appendChild(this.createInfoButton(c)),O.appendChild(this.createDownloadButton(c)),t&&(O.appendChild(this.createCoverButton(c)),O.appendChild(this.createDeleteButton(c))),T.onload=()=>{T.classList.remove("opacity-0"),v.classList.add("opacity-0"),setTimeout(()=>c.removeChild(v),1e3)},c},async album(e){const t=document.createElement("a");if(t.className="grid-item card clickable selectable position-relative rounded-0 ratio ratio-4x3 w-100 p-0 my-1 border-0",t.href=route("albums.show",{id:e.id}),t.setAttribute("data-id",e.id),e.cover){const g=await this._createBlurHash(e.cover);g.className="d-block position-absolute object-fit-cover w-100 h-100",t.appendChild(g);const y=document.createElement("img");y.className="d-block object-fit-cover",y.src=`photos/${e.cover.id}/thumbnail`,y.loading="lazy",t.appendChild(y)}const n=R("check-circle-fill","opacity-75 h-auto w-auto position-absolute top-50 start-50 translate-middle");t.appendChild(n);const r=document.createElement("div");r.className="card-img-overlay bottom badge rounded-pill bg-secondary text-light fw-bold px-2 py-1 m-1 me-2",r.textContent=e.photos,t.appendChild(r);const s=document.createElement("div");s.className="card-img-overlay top rounded-0 bg-dark text-light fw-semibold text-truncate p-2",s.textContent=e.name,t.appendChild(s);const c=document.createElement("div");return c.className="d-block quick-actions p-1 pe-2",t.appendChild(c),c.appendChild(this.createModifyButton(t)),c.appendChild(this.createDeleteButton(t)),t},separator(e){const t=document.createElement("h5");return t.className="text-dark-emphasis p-2 pb-1 mt-4 fw-semibold border-bottom",t.innerText=e,t},createInfoButton(e){const t=document.createElement("button");t.className="btn btn-light btn-sm me-1 btn-info";const n=R("info-circle-fill","text-secondary");return t.appendChild(n),t},createDownloadButton(e){const t=document.createElement("button");t.className="btn btn-light btn-sm me-1 btn-download";const n=R("download","text-secondary");return t.appendChild(n),t},createCoverButton(e){const t=document.createElement("button");t.className="btn btn-light btn-sm me-1 btn-cover no-share";const n=R("star-fill","text-secondary");return t.appendChild(n),t},createModifyButton(e){const t=document.createElement("button");t.className="btn btn-light btn-sm me-1 btn-modify no-share";const n=R("pencil-fill","text-secondary");return t.appendChild(n),t},createDeleteButton(e){const t=document.createElement("button");t.className="btn btn-light btn-sm btn-delete no-share";const n=R("trash3","text-secondary");return t.appendChild(n),t},async _createBlurHash(e,t=250,n=250){let r=e.blurhash;return r=typeof r=="string"&&r.length>=6?r:"LFRf8~-;?.OF?Hf8ShkB%vWrIEs9",await ft.getImageDataAsImageWithOnloadPromise(ft.decode(r,t,n),t,n)}};export{Dt as G,Ot as M,St as P,kt as a};
