const u=(function(){let n=!1,e=0;const s=document.getElementById("indicator-loading");function o(){s&&(s.classList.toggle("d-none",e===0&&!n),s.classList.toggle("text-danger",n))}return{start:function(){e++,o()},stop:function(){e>0&&(e--,o())},error:function(){e>0&&(n=!0,o())},isLoading:function(){return e>0&&!n},reset:function(){e=0,o()}}})(),d=(function(){const n=new Set;return{isLoading(e=null){return e?n.has(e):n.size>0},async request(e,s="GET",o=null,p=null,c=!0){const i=p||`${s.toUpperCase()}:${e}`;if(n.has(i)){console.warn("Request already in progress:",i);return}n.add(i),c&&u.start();const a={method:s.toUpperCase(),credentials:"include",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content,Accept:"application/json","Content-Type":"application/json"}};if(o){const t=o instanceof FormData;a.body=t?o:JSON.stringify(o),t||(a.headers["Content-Type"]="application/json")}try{let t;const r=await fetch(e,a);if((r.headers.get("content-type")||"").includes("application/json"))try{t=await r.json()}catch(l){console.log(l)}else t=await r.text();if(!r.ok){c&&u.error(r.status);const l=typeof t=="object"&&t?.message||t;throw new Error(l||"Request failed")}return t}catch(t){throw console.log(t),t}finally{n.delete(i),c&&u.stop()}}}})();export{d as A};
