const p=(function(){let n=!1,o=0;const t=document.getElementById("indicator-loading");function s(){t&&(t.classList.toggle("d-none",o===0&&!n),t.classList.toggle("text-danger",n))}return{start:function(){o++,s()},stop:function(){o>0&&(o--,s())},error:function(){o>0&&(n=!0,s())},isLoading:function(){return o>0&&!n},reset:function(){o=0,s()}}})(),g=(function(){const n=new Set;function o(t){const i=`; ${document.cookie}`.split(`; ${t}=`);return i.length===2?i.pop().split(";").shift():null}return{isLoading(t=null){return t?n.has(t):n.size>0},async request(t,s="GET",i=null,f=null,l=!0){const a=f||`${s.toUpperCase()}:${t}`;if(n.has(a)){console.warn("Request already in progress:",a);return}n.add(a),l&&p.start();const r={method:s.toUpperCase(),credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}};if(!["GET","HEAD","OPTIONS"].includes(r.method)){const e=o("XSRF-TOKEN");e&&(r.headers["X-XSRF-TOKEN"]=decodeURIComponent(e))}if(i){const e=i instanceof FormData;r.body=e?i:JSON.stringify(i),e||(r.headers["Content-Type"]="application/json")}try{let e;const c=await fetch(t,r);if((c.headers.get("content-type")||"").includes("application/json"))try{e=await c.json()}catch(u){console.log(u)}else e=await c.text();if(!c.ok){l&&p.error(c.status);const u=typeof e=="object"&&e?.message||e;throw new Error(u||"Request failed")}return e}catch(e){throw console.log(e),e}finally{n.delete(a),l&&p.stop()}}}})();export{g as A};
