const c=(function(){let e=!1,t=0;const s=document.getElementById("indicator-loading");function o(){s&&(s.classList.toggle("d-none",t===0&&!e),s.classList.toggle("text-danger",e))}return{start(){t++,o()},stop(){t>0&&(t--,o())},error(a){t>0&&a>=500&&(e=!0,o())},isLoading(){return t>0&&!e},reset(){t=0,e=!1,o()}}})(),p=(function(){const e=new Set;return{isLoading(t=null){return t?e.has(t):e.size>0},async request(t,s="GET",o=null,a=null){const r=a||`${s.toUpperCase()}:${t}`;if(e.has(r)){console.warn("Request already in progress:",r);return}e.add(r),c.start();const i={method:s.toUpperCase(),credentials:"include",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content,Accept:"application/json","Content-Type":"application/json"}};if(o){const n=o instanceof FormData;i.body=n?o:JSON.stringify(o),n||(i.headers["Content-Type"]="application/json")}try{const n=await fetch(t,i);if(!n.ok){const l=n.status;c.error(l);const u=await n.json().catch(()=>({}));throw new Error(u.message||"Request failed")}return await n.json()}catch(n){throw console.log(n),n}finally{e.delete(r),c.stop()}}}})();export{p as A};
